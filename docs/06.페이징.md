## IA-32e 모드 페이징
레벨 4개의 페이징을 지원함. 세그멘테이션은 존재하지 않음. 따라서 논리주소가 바로 선형주소임.

선형주소의 4개 부분은 각 레벨 별 오프셋임. 

선형주소를 다음과 같이 4개 부분으로 나눔 : (부호확장)(16), PML4(9), 디렉토리 포인터(9), 디렉터리(9), 오프셋(21)

페이징에 사용되는 각 테이블들은 2^9개의 엔트리로 구성되며, 각 엔트리에는 다음 레벨에서 사용할 테이블의 기준 주소(Base Address)를 포함함.

엔트리들은 보통 8바이트임.

각 엔트리들의 하위 바이트에 곧바로 주소를 넣을 수 있는데, 이는 애초에 기준 주소들이 뒤 비트가 0이어야만 하기 때문임. (Aligned)

왜냐하면, 각 페이지 테이블들은 512 * 8, 즉 4KB 크기이므로, 아래의 12비트가 0이어야함.

페이지 디렉토리에서는, 페이지가 2MB이므로 페이지 디렉토리 안에 들어있는 기준 주소의 아래의 21비트가 0이어야함.

## MINT OS 페이징
2MB 페이지를 사용하며, 최대 64GB의 물리 메모리를 매핑함.

64GB 물리 메모리를 관리하기 위해 필요한 테이블의 수는?

#### 페이지 디렉토리
페이지 디렉토리 1개는 2MB * 512, 즉 2^21 * 2^9 = 2^30B, 즉 1GB의 메모리를 관리할 수 있다.

따라서 64개의 페이지 디렉토리가 필요함.

#### 디렉토리 포인터
64개의 페이지 디렉토리를 관리하려면 단 1개의 디렉토리 포인터가 필요함. (1개의 디렉토리 포인터는 512개의 페이지 디렉토리를 관리할 수 있음.)

#### PML4
1개의 디렉토리 포인터를 관리하려면 1개의 PML4 테이블이 필요함.

#### 총합
각각의 테이블은 512 * 8 byte, 즉 2^12 바이트, 4KB 크기임.

(64 + 1 + 1) * 4KB = 264KB가 테이블만을 위해 필요함.

애매하게 큰 용량이므로 커널 이미지에 포함시킬 것이 아니라, 런타임에 만드는게 좋음.

또한 kernel64의 0x200000~0x600000에 들어가기에도 크기 때문에, 0x100000~0x200000에 두는 것이 좋음.

참고 : 엔트리에 들어있는 주소는 물리 주소임.

### CR3
PDBR이라고 하며, 최상위 페이지테이블의 주소를 프로세서에게 알리는 역할

### CR4
64비트 모드에서 2MB 페이징을 활성화 하려면,
1. CR4의 PAE 비트를 활성화하고,
2. 페이지 디렉토리 엔트리들의 PS 비트를 1로 설정해야함.

## CR0
CR0의 페이징 비트를 활성화하는 순간부터 바로 페이징 모드가 시작됨.

